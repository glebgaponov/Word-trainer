<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–Ω–∞–∂–µ—Ä —Å–ª–æ–≤</title>
    <link rel="stylesheet" href="style.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: #f0f2f5;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .tab-btn {
            padding: 12px 24px;
            border: none;
            background: #007bff;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .tab-btn.active {
            background: #0056b3;
        }
        
        .tab-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .quiz-question {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .options {
            margin: 10px 0;
        }
        
        .option {
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .option:hover {
            background: #f8f9fa;
        }
        
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
        }
        
        .correct {
            background: #d4edda;
            color: #155724;
        }
        
        .wrong {
            background: #f8d7da;
            color: #721c24;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: #007bff;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
        }
        
        button {
            padding: 10px 20px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 0;
        }
        
        button:hover {
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö –¢—Ä–µ–Ω–∞–∂–µ—Ä —Å–ª–æ–≤</h1>
            <p>–£—á–∏—Ç–µ —Å–ª–æ–≤–∞ —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç—ã</p>
        </header>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('training')">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</button>
            <button class="tab-btn" onclick="showTab('stats')">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
        </div>
        
        <!-- –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ -->
        <div id="training" class="tab-content active">
            <h2>–¢–µ—Å—Ç –Ω–∞ –∑–Ω–∞–Ω–∏–µ —Å–ª–æ–≤</h2>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤:</p>
            <select id="questionCount">
                <option value="3">3 –≤–æ–ø—Ä–æ—Å–∞</option>
                <option value="5" selected>5 –≤–æ–ø—Ä–æ—Å–æ–≤</option>
                <option value="10">10 –≤–æ–ø—Ä–æ—Å–æ–≤</option>
            </select>
            
            <button onclick="startQuiz()">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</button>
            
            <div id="quiz-container"></div>
            
            <div id="quiz-result" style="margin-top: 20px;"></div>
        </div>
        
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div id="stats" class="tab-content">
            <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è</h2>
            <button onclick="loadStats()">–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
            
            <div id="stats-container">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è —Å—é–¥–∞ -->
            </div>
        </div>
    </div>

    <script>
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –≤–∫–ª–∞–¥–∫—É
        function showTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName).classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            event.target.classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
            if (tabName === 'stats') {
                loadStats();
            }
        }
        
        // –ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç
        async function startQuiz() {
            const count = document.getElementById('questionCount').value;
            
            try {
                const response = await fetch(`/api/quiz?count=${count}`);
                const quiz = await response.json();
                
                const container = document.getElementById('quiz-container');
                container.innerHTML = '';
                
                quiz.forEach((question, index) => {
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'quiz-question';
                    questionDiv.innerHTML = `
                        <h3>–í–æ–ø—Ä–æ—Å ${index + 1}: ${question.question}</h3>
                        <div class="options">
                            ${question.options.map(option => `
                                <div class="option" onclick="checkAnswer(${question.id}, '${option}', this)">
                                    ${option}
                                </div>
                            `).join('')}
                        </div>
                        <div id="result-${question.id}"></div>
                    `;
                    container.appendChild(questionDiv);
                });
                
                // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                document.getElementById('quiz-result').innerHTML = '';
                
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–µ—Å—Ç–∞');
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç
        async function checkAnswer(wordId, answer, element) {
            try {
                const response = await fetch('/api/check', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ wordId, answer })
                });
                
                const result = await response.json();
                const resultDiv = document.getElementById(`result-${wordId}`);
                
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –æ—Ç–≤–µ—Ç
                element.style.background = result.isCorrect ? '#d4edda' : '#f8d7da';
                element.style.borderColor = result.isCorrect ? '#c3e6cb' : '#f5c6cb';
                
                resultDiv.innerHTML = `
                    <div class="result ${result.isCorrect ? 'correct' : 'wrong'}">
                        ${result.isCorrect ? '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!' : '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!'}
                        <br>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: <strong>${result.correctAnswer}</strong>
                    </div>
                `;
                
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –æ—Ç–≤–µ—Ç–∞');
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const stats = await response.json();
                
                const container = document.getElementById('stats-container');
                
                let html = `
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>–í—Å–µ–≥–æ —Å–ª–æ–≤</h3>
                            <div class="stat-value">${stats.totalWords}</div>
                        </div>
                        <div class="stat-card">
                            <h3>–í—Å–µ–≥–æ –æ—Ç–≤–µ—Ç–æ–≤</h3>
                            <div class="stat-value">${stats.totalAnswers}</div>
                        </div>
                        <div class="stat-card">
                            <h3>–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö</h3>
                            <div class="stat-value">${stats.correctAnswers}</div>
                        </div>
                        <div class="stat-card">
                            <h3>–¢–æ—á–Ω–æ—Å—Ç—å</h3>
                            <div class="stat-value">${stats.accuracy}</div>
                        </div>
                    </div>
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
                if (Object.keys(stats.categories).length > 0) {
                    html += `<h3 style="margin-top: 30px;">–ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:</h3>`;
                    
                    for (const [category, data] of Object.entries(stats.categories)) {
                        html += `
                            <div style="background: #f8f9fa; padding: 15px; margin: 10px 0; border-radius: 5px;">
                                <strong>${category}:</strong><br>
                                –°–ª–æ–≤: ${data.count} | 
                                –ü—Ä–∞–≤–∏–ª—å–Ω–æ: ${data.correct} | 
                                –û—à–∏–±–æ–∫: ${data.wrong}
                            </div>
                        `;
                    }
                }
                
                container.innerHTML = html;
                
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏');
            }
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = loadStats;
    </script>
</body>
</html>